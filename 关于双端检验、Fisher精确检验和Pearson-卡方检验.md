## 关于双端检验、Fisher精确检验和Pearson-卡方检验（上）



我们从抛硬币开始说。我们知道，假设是均匀的硬币（ 扔到正面的概率 $p(Head)=p_0=0.5$ ），那么硬币扔到正反面的概率各是0.5。扔这样扔一个硬币的结果是一个伯努利分布。我们这么解释：假设”这一次投掷“**结果为 $x$ 次正面**，那么有：

$p(0)=p_0=0.5 \;\;\; p(1)=1-p_0=0.5$



非常Obvious。因为一共就扔了一个硬币， $x$ **只有可能是0或1**。

我们扔这个硬币20次，再假设“这20次投掷”的**结果为 $x$ 次正面**，那么x满足二项分布，即$X\sim B(20,0.5)$。不难由定义想到，$0 \leq x \leq 20$（因为一共扔20次硬币，最多20次正面，最少0次正面）。

我们扔这个硬币$n$次，再假设“这n次投掷”的**结果为 $x$ 次正面**，那么x满足二项分布，即$X\sim B(n,0.5)$。



假设硬币不均匀了，扔到正面的概率 $p(Head)=p_0\neq 0.5$，我们继续：

我们扔这个**不均匀的**硬币$n$次，再假设“这$n$次投掷”的**结果为 $x$ 次正面**，那么x满足二项分布，即$X\sim B(n,p_0)$。



这是我模拟的结果：假设做100000次实验，每次**扔10次硬币**，横轴为$x$，纵轴$y$为正面朝上为$x$次的实验次数。（其中蓝点为概率计算的结果，红点为模拟结果）：

<img src="G:\zhongyunhua\大学\大二上\概率论-NJUAI\作业&大作业文件\大作业 图\bino1.png" alt="bino1" style="zoom:67%;" />

可以看到，5次朝上的概率是最多的。而且这个曲线是一个类似于正态分布的钟形曲线。

正态分布曲线如下图，假设$x$满足标准正态分布，即$x \sim N(0,1)$，则x和x的概率密度$Density(x)$如图：

<img src="https://img2.baidu.com/it/u=2265935811,1037801342&fm=253&fmt=auto&app=138&f=JPEG?w=700&h=500" alt="img" style="zoom: 67%;" />

可以看到，$x$ 取到接近0的概率较大，远离0的概率较小。也就是说，$|x|$ （x绝对值）较大的概率**比较小**。



也就是说，我现在进行“一次事件”，我们假设一次中不会发生小概率事件，否则就是前提有问题，这就是**“假设检验”**的核心思想。

举个例子：我们假设明日方舟一抽出货6星的概率为2%。我们默认是相信，游戏官方是不会骗我们的。我们相信的前提叫做原假设，反之叫做备择假设。故：

原假设：游戏的概率没问题，一抽出货6星的概率为2%

备择假设：游戏的概率有问题，一抽出货6星的概率 **不** 为2%



现在菲菲同学进行了单抽，出货了6星。**原假设为真的前提下**，发生这一事件的概率为2%，这是一个小于$p=0.05=5\%$的**小概率**事件。如果我们只有这个单抽的结果（只允许抽一次卡），我们可以相信，原假设**（前提）**有问题，因为我们遇上了一个小概率事件。

因此，我们称：单抽出6星在$p=0.05$的条件下（和大概率结果）有**显著性差异**。



同理，我们取一个（我们相信）满足标准正态分布的$x$，查看它的值。因此，根据我们的信念：

原假设：$x$ **满足**标准正态分布

备择假设：$x$ **不满足**标准正态分布

现在我们查看$x$的值，发现$|x|$ 比较大。我们知道，$|x|$ 较大的概率**比较小**，因此这是一个小概率事件，即我们否定原假设，认为$x$ **不满足**标准正态分布。



$|x|$ 比较大分为两种情况，$x$较大或者$x$很小都有可能，因此$x$落在两端都要排除，这就是**双侧检验**。

![img](https://img0.baidu.com/it/u=940701244,2714029171&fm=253&fmt=auto&app=138&f=GIF?w=500&h=362)

然后我们举一个生物的例子：

我们现在研制了一种新药，但我们在做实验前始终抱有反过来的怀疑，即：新药**没有**什么进步，即和老药没有显著区别。然后，我们获得了新药和老药的疾病治愈率$x_0$和$x_1$。因此，根据我们的信念：

原假设：新药的治愈率$x_0=x_1$

备择假设：新药的治愈率$x_0\neq x_1$



（假如）我们通过计算得知了$y=$|$x_0 - x_1$|是个满足方差为1的正态分布的变量，假设原假设是对的，那么满足$\mu(y)= 0$。

那么就有：

原假设：y**满足**标准正态分布$N(0,1)$

备择假设：y**不满足**标准正态分布，但我们已经确定y方差为1，即$y \sim N(k,1),k\neq 0$。

随后我们查看$y$的值。如果|$y$|比较大，那么根据我们之前这个例子，我们知道原假设是错的（前提有问题），即我们从结果上证实了新药的治愈率$x_0\neq x_1$。不管新药是更差还是更好，它至少和老药**是有区别的**。



假设我们现在换一个**我们相信的前提**，即：我们相信**新药不会比老药差**，那么：

原假设：新药的治愈率$x_0\geq x_1$

备择假设：新药的治愈率$x_0 < x_1$



我们还是通过计算得知了$y=$|$x_0 - x_1$|是个满足方差为1的正态分布的变量，假设原假设是对的，那么满足$\mu(y)> 0$。



随后我们查看$y$的值。如果y比较小，那么我们知道原假设是错的（前提有问题），即我们从结果上证实了新药的治愈率$x_0 < x_1$。但如果y比较大，它和我们的原假设是**符合的**，我们不拒绝原假设，因此只有y落在单边时我们才否定原假设，这就是**单侧检验**。



回到最开始的例子。从图中，我们知道**扔10次（均匀）硬币**的话，正面朝上的次数 $x$ 接近0或者接近10的概率都是比较小的。因此根据我们的信念：

原假设：硬币是均匀的，$p(Head)=p_0=0.5$

备择假设：硬币**不是**均匀的，$p(Head)=p_0\neq0.5$

<img src="G:\zhongyunhua\大学\大二上\概率论-NJUAI\作业&大作业文件\大作业 图\bino1.png" alt="bino1" style="zoom:67%;" />

我们现在扔10次硬币来作为实验。假设正面朝上的次数 $x$ 接近0或者接近10，这是一个小概率事件，我们有理由认为原假设是错的，即硬币**不是**均匀的。（这是**双边检验**）



假设我们现在信念变了，原假设和备择假设如下。

原假设：硬币不是均匀的，而且正面**更可能朝上**，$p(Head)=p_0>0.5$

备择假设：不管硬币是不是均匀的，没有正面**更可能朝上**的可能性，$p(Head)=p_0\leq0.5$



我们现在扔10次硬币来作为实验。假设正面朝上的次数 $x$ 接近0，这是一个**在原假设作为前提下**的小概率事件，我们有理由认为原假设是错的，即硬币没有正面**更可能朝上**的可能性。

但假设 $x$ 接近10，这说明确实硬币正面**更可能朝上**，我们不否决原假设。（这是**单边检验**）